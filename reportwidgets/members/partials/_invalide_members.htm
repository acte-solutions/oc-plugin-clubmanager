<div class="report-widget">
    <h3 style="color: #cc3300">Members without valid ticket (<?= $this->property('limitRecords') ?>)</h3>

    <div class="table-container">
        <table class="table data" data-control="rowlink">
            <thead>
                <tr>
                    <th width="200px;">Member</th>
                    <th class="sort-desc">Last expired ticket</th>
                </tr>
            </thead>
            <tbody>
                <?php if(! $records->isEmpty()): ?>

                  <?php foreach($records as $key => $record): ?>
                  <tr>
                      <td>
                        <span class="list-badge badge-warning">
                          <i class="icon-exclamation"></i>
                        </span>
                        <a href="<?= Backend::url('acte/clubmanager/members/update/'.$record->id) ?>">
                          <?= $record->name ?>
                        </a>
                      </td>
                      <td>
                        <?php if(isset($record->ticket->first()->expire_date)): ?>
                          <?= date_format($record->ticket->first()->expire_date, 'd M Y'); ?>
                        <?php else: ?>
                          none
                        <?php endif ?>
                      </td>
                  </tr>
                  <?php endforeach ?>

                <?php else: ?>

                  <tr class="no-data">
                    <td colspan="100" class="nolink">
                        <p class="no-data">
                            There are no records in this view.
                        </p>
                    </td>
                  </tr>

                <?php endif ?>
            </tbody>
        </table>
    </div>
</div>
